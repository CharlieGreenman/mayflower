{# if maxItems was set by parent component, use it.  Otherwise set it to all. #}
{% set  maxItems = maxItems ? maxItems : googleMap.markers|length %}
<div
  class="ma__google-map"
  aria-hidden="true"
  role="presentation">
  {# for static maps #}
  {% if googleMap.static %}
  <div class="ma__google-map__map">
  {# set vars for img tag #}
    {% set center = googleMap.map.center.lat~"," ~googleMap.map.center.lng %}
    {% set zoom =  googleMap.map.zoom %}
    
    {# set empty var for multiple marker values#}
    {% set markers = "" %}
    {% for marker in googleMap.markers %} 
    {# loop through markers #}
      {% set marker = "&markers=label:" ~ marker.label ~"%7C" ~ marker.position.lat ~","~ marker.position.lng %}
      {% set markers = markers ~ marker %}
    {% endfor %}
    {# example url for images https://maps.googleapis.com/maps/api/staticmap?center=63.259591,-144.667969&zoom=6&markers=label:S%7C62.107733,-145.541936&markers=... #}
    <img src="https://maps.googleapis.com/maps/api/staticmap?center={{ center }}&zoom={{ zoom }}{{ markers }}" alt="Click for directions">
  </div>
  {% else %}
  {# for google maps#}
  <div class="ma__google-map__map js-google-map"></div>
  {# user editable data used in this specific map #}
  <script>
    // Make googleMap data object available in google map module js.
    var ma = ma || {};
    ma.googleMapData = ma.googleMapData || [];
    ma.googleMapData.push({
      map: {
        center: {
          lat: {{googleMap.map.center.lat}},
          lng: {{googleMap.map.center.lng}}
        },
        zoom: {{googleMap.map.zoom}}
      },
      maxItems: {{ maxItems }},
      markers: [
      {% for marker in googleMap.markers %}
        {
          position: {
            lat: {{marker.position.lat}},
            lng: {{marker.position.lng}}
          },
          label: "{{ marker.label }}", // single character only
          infoWindow: {
            name: "{{ marker.infoWindow.name|e('js') }}",
            link: "{{ marker.infoWindow.link|e('js') }}",
            phone: "{{ marker.infoWindow.phone|e('js') }}",
            fax: "{{ marker.infoWindow.fax|e('js') }}",
            email: "{{ marker.infoWindow.email|e('js') }}",
            address: "{{ marker.infoWindow.address|replace({'\n': '<br>'})|e('js') }}",
            directions: "{{ marker.infoWindow.directions|e('js') }}"
          }
        }{{ loop.last ? '' : ',' }}
      {% endfor %}
      ]
    });
  </script>
  {% endif %}
</div>
